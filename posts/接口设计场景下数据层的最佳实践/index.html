<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="è¿™æ˜¯ä¸€ä¸ªä¸ªäººåšå®¢ï¼Œè®°å½•æŠ€æœ¯å­¦ä¹ å’Œç”Ÿæ´»æ„Ÿæ‚Ÿ"><title>æ¥å£è®¾è®¡åœºæ™¯ä¸‹æ•°æ®å±‚çš„æœ€ä½³å®è·µ | RenaXu 's Wonderland</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=1.0.0"><link rel="stylesheet" type="text/css" href="/css/custom-icons.css?v=1.0.0"><link rel="stylesheet" type="text/css" href="/css/toc.css?v=1.0.0"><link rel="stylesheet" type="text/css" href="https://unpkg.com/normalize.css"><link rel="stylesheet" type="text/css" href="https://unpkg.com/purecss/build/pure-min.css"><link rel="stylesheet" type="text/css" href="https://unpkg.com/purecss/build/grids-responsive-min.css"><link rel="stylesheet" href="https://unpkg.com/font-awesome@4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="https://unpkg.com/jquery/dist/jquery.min.js"></script><link rel="icon" mask="" sizes="any" href="/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><script type="text/javascript" src="https://unpkg.com/clipboard/dist/clipboard.min.js"></script><script type="text/javascript" src="https://unpkg.com/toastr/build/toastr.min.js"></script><link rel="stylesheet" href="https://unpkg.com/toastr/build/toastr.min.css"><div class="darkmode-toggle">ğŸŒ“</div><script>var prefersDarkMode = window.matchMedia('(prefers-color-scheme: dark)');
var toggle = document.querySelector('.darkmode-toggle');
var html = document.querySelector('html');

html.dataset.dark = localStorage.dark || prefersDarkMode.matches;

toggle.addEventListener('click', () => {
localStorage.dark = !(html.dataset.dark == 'true');
html.dataset.dark = localStorage.dark;
});</script><meta name="generator" content="Hexo 8.1.1"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">æ¥å£è®¾è®¡åœºæ™¯ä¸‹æ•°æ®å±‚çš„æœ€ä½³å®è·µ</h1><a id="logo" href="/.">RenaXu 's Wonderland</a><p class="description">åˆ†äº«æŠ€æœ¯ä¸ç”Ÿæ´»</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> é¦–é¡µ</i></a><a href="/archives/"><i class="fa fa-archive"> å½’æ¡£</i></a><a href="/about/"><i class="fa fa-user"> å…³äº</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-4-4"><div class="content_container"><div class="post"><h1 class="post-title">æ¥å£è®¾è®¡åœºæ™¯ä¸‹æ•°æ®å±‚çš„æœ€ä½³å®è·µ</h1><div class="post-meta">2025-11-23<span> | </span><span class="category"><a href="/categories/%E6%8A%80%E6%9C%AF/">æŠ€æœ¯</a></span><span class="post-time"><span class="post-meta-item-text"> | </span><span class="post-meta-item-icon"><i class="fa fa-keyboard-o"></i><span class="post-count"> 1.1k</span><span class="post-meta-item-text"> å­—</span></span></span><span class="post-time"> | <span class="post-meta-item-icon"><i class="fa fa-clock-o"></i><span class="post-count"> 5</span><span class="post-meta-item-text"> åˆ†é’Ÿ</span></span></span></div><div class="clear"><div class="toc-article" id="toc"><div class="toc-title">æ–‡ç« ç›®å½•</div><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link"><span class="toc-text">è®¾è®¡æ•°æ®åº“çš„å°tips</span></a></li><li class="toc-item toc-level-2"><a class="toc-link"><span class="toc-text">Gormæ“ä½œmysql æœ€ä½³å®è·µï¼ˆè®¾è®¡æ¥å£å¸¸ç”¨ï¼‰</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link"><span class="toc-text">åœºæ™¯ 1: æ ¹æ®æ¡ä»¶æŸ¥è¯¢è¡Œè®°å½• (SELECT *)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link"><span class="toc-text">åœºæ™¯ 2: æ ¹æ®æ¡ä»¶æŸ¥è¯¢è¡Œè®°å½•çš„æŒ‡å®šåˆ—çš„å€¼</span></a></li><li class="toc-item toc-level-3"><a class="toc-link"><span class="toc-text">åœºæ™¯ 3: æ ¹æ®æ¡ä»¶ï¼ˆåŒ…æ‹¬å…³è”è¡¨çš„åˆ—ï¼‰æŸ¥è¯¢è¡Œè®°å½•çš„æŒ‡å®šåˆ—çš„å€¼</span></a></li><li class="toc-item toc-level-3"><a class="toc-link"><span class="toc-text">åœºæ™¯ 4: æ ¹æ®ä¸»é”® ID æ›´æ–°æŒ‡å®šåˆ—çš„æ•°æ®ï¼Œå¹¶è¿”å›æ›´æ–°è¡Œçš„è®°å½•</span></a></li><li class="toc-item toc-level-3"><a class="toc-link"><span class="toc-text">åœºæ™¯ 5: æ’å…¥ä¸€æ¡æ–°æ•°æ®ï¼Œå¦‚æœæ•°æ®å·²å­˜åœ¨åˆ™æ›´æ–°ï¼ˆUPSERTï¼‰</span></a></li></ol></li></ol></div></div><div class="post-content"><h2><span id="è®¾è®¡æ•°æ®åº“çš„å°tips">è®¾è®¡æ•°æ®åº“çš„å°tips</span></h2><p>1ã€æ•°æ®åº“è¡¨å­—æ®µä¸å»ºè®®è®¾ç½®å€¼æ—¶å…è®¸ä¸ºnullã€‚</p>
<ul>
<li><p><strong><code>NULL</code> çš„æ¯”è¾ƒç‰¹æ€§</strong>ï¼šä»»ä½•ä¸ <code>NULL</code> çš„æ¯”è¾ƒï¼ˆ<code>=</code>, <code>!=</code>, <code>&lt;</code>, <code>&gt;</code>ï¼‰ç»“æœéƒ½ä¸æ˜¯ <code>TRUE</code> æˆ– <code>FALSE</code>ï¼Œè€Œæ˜¯ <code>UNKNOWN</code>ã€‚è¿™ä½¿å¾— <code>WHERE</code> å­å¥çš„è¡Œä¸ºå˜å¾—éš¾ä»¥é¢„æµ‹ã€‚</p>
</li>
<li><p><strong>å‡½æ•°ä¸è¿ç®—çš„è¡Œä¸ºä¸ç¡®å®š</strong>ï¼šå¤§å¤šæ•°èšåˆå‡½æ•°ï¼ˆå¦‚ <code>SUM</code>, <code>AVG</code>, <code>COUNT</code>ï¼‰ä¼šå¿½ç•¥ <code>NULL</code> å€¼ï¼Œè¿™å¯èƒ½ä¸å¼€å‘è€…çš„ç›´è§‰ä¸ç¬¦ã€‚</p>
</li>
<li><p><strong><code>NULL</code> å€¼ä¼šå¢åŠ å­˜å‚¨å¼€é”€</strong>ï¼Œä¸ºnullå®ƒä»£è¡¨çš„æ˜¯æ•°æ®æœªçŸ¥ï¼Œä»–ä¼šåœ¨æ•°æ®çš„è¡Œæ•°æ®ä¸­å•ç‹¬ç”¨ä¸€åˆ—æ¥è¡¨ç¤ºå“ªäº›åˆ—æ˜¯ç©ºçš„ï¼ˆç”¨ä½å›¾è¡¨ç¤ºï¼Œå¦‚00010ï¼Œè¡¨ç¤ºç¬¬3è¡Œï¼ˆä»¥0ä¸ºå¼€å§‹ï¼‰è¡¨ç¤ºä¸ºnullï¼‰ï¼Œä¸è¿‡æ•°æ®éƒ¨åˆ†å°±ä¸å ç”¨ç©ºé—´äº†ã€‚</p>
</li>
</ul>
<p>2ã€å°†æ•°æ®åº“æŸ¥è¯¢é€»è¾‘æ˜¾ç¤ºæš´éœ²åˆ°é€»è¾‘ä¸Šè€Œé¿å…ä½¿ç”¨å¤æ‚çš„sqlè¯­å¥<br>æ–¹ä¾¿åç»­å®šä½é—®é¢˜ã€‚</p>
<p>3ã€åœ¨æ•°æ®åº“ä¸­è¡¨è®¾è®¡ä¸­ï¼Œä¸å»ºè®®è®¾ç½®å¤–é”®ã€‚<br>å¯¹è®°å½•çš„åˆ é™¤å’Œæ’å…¥éƒ½ä¼šå¯¹å…³è”è¡¨åšæ•°æ®å®Œæ•´æ€§æ£€æŸ¥ï¼Œæœ‰çš„æ—¶å€™è¿™å¯èƒ½æ˜¯ä¸å¿…è¦çš„ï¼Œè¿™äº›åº”è¯¥æŠŠå®ƒæš´éœ²åˆ°ä¸šåŠ¡é€»è¾‘å±‚æ¥åšã€‚ä¸»è¦è¿˜æ˜¯å¢åŠ æ€§èƒ½å¼€é”€ã€‚</p>
<h2><span id="gormæ“ä½œmysql-æœ€ä½³å®è·µè®¾è®¡æ¥å£å¸¸ç”¨">Gormæ“ä½œmysql æœ€ä½³å®è·µï¼ˆè®¾è®¡æ¥å£å¸¸ç”¨ï¼‰</span></h2><h3><span id="åœºæ™¯-1-æ ¹æ®æ¡ä»¶æŸ¥è¯¢è¡Œè®°å½•-select">åœºæ™¯ 1: æ ¹æ®æ¡ä»¶æŸ¥è¯¢è¡Œè®°å½• (SELECT *)</span></h3><p><strong>Sql</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> student <span class="keyword">WHERE</span> age <span class="operator">=</span> <span class="number">26</span> <span class="keyword">AND</span> grade <span class="operator">=</span> &quot;1å¹´çº§&quot;;</span><br></pre></td></tr></table></figure>

<p><strong>GORM æ“ä½œ</strong>	</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> students []Student</span><br><span class="line">result := db.Where(<span class="string">&quot;age = ? AND grade = ?&quot;</span>, <span class="number">26</span>, <span class="string">&quot;1å¹´çº§&quot;</span>).Find(&amp;students)</span><br></pre></td></tr></table></figure>

<h3><span id="åœºæ™¯-2-æ ¹æ®æ¡ä»¶æŸ¥è¯¢è¡Œè®°å½•çš„æŒ‡å®šåˆ—çš„å€¼">åœºæ™¯ 2: æ ¹æ®æ¡ä»¶æŸ¥è¯¢è¡Œè®°å½•çš„æŒ‡å®šåˆ—çš„å€¼</span></h3><p><strong>sql</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> id, grade, age <span class="keyword">FROM</span> student <span class="keyword">WHERE</span> age <span class="operator">=</span> <span class="number">26</span>;</span><br></pre></td></tr></table></figure>

<p><strong>GORM æ“ä½œ</strong></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ–¹å¼ä¸€ï¼Œæ³¨æ„ä¸€å®šè¦ç”¨.Model(&amp;Student&#123;&#125;)ï¼ï¼å¦åˆ™ä¸ç”Ÿæ•ˆ</span></span><br><span class="line"><span class="keyword">var</span> results []<span class="keyword">map</span>[<span class="type">string</span>]<span class="keyword">interface</span>&#123;&#125;</span><br><span class="line">result := db.Model(&amp;Student&#123;&#125;).Select(<span class="string">&quot;id&quot;</span>, <span class="string">&quot;grade&quot;</span>, <span class="string">&quot;age&quot;</span>).Where(<span class="string">&quot;age = ?&quot;</span>, <span class="number">26</span>).Find(&amp;results)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// æ–¹å¼äºŒï¼Œæ³¨æ„ä¸€å®šè¦ç”¨.Model(&amp;Student&#123;&#125;)ï¼ï¼å¦åˆ™ä¸ç”Ÿæ•ˆ</span></span><br><span class="line"><span class="keyword">type</span> StudentInfo <span class="keyword">struct</span> &#123;</span><br><span class="line">  ID    <span class="type">uint</span></span><br><span class="line">  Grade <span class="type">string</span></span><br><span class="line">  Age   <span class="type">int</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> infos []StudentInfo</span><br><span class="line">db.Model(&amp;Student&#123;&#125;).Select(<span class="string">&quot;id&quot;</span>, <span class="string">&quot;grade&quot;</span>, <span class="string">&quot;age&quot;</span>).Where(<span class="string">&quot;age = ?&quot;</span>, <span class="number">26</span>).Find(&amp;infos) </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>æ³¨æ„âš ï¸ï¼šå½“ä½¿ç”¨ <code>Find To Map</code>æ—¶ï¼Œä¸€å®šè¦åœ¨ä½ çš„æŸ¥è¯¢ä¸­åŒ…å« <code>Model</code> æˆ–è€… <code>Table</code> ï¼Œä»¥æ­¤æ¥æ˜¾å¼åœ°æŒ‡å®šè¡¨åã€‚ è¿™èƒ½ç¡®ä¿ GORM æ­£ç¡®çš„ç†è§£å“ªä¸ªè¡¨è¦è¢«æŸ¥è¯¢ã€‚<a target="_blank" rel="noopener" href="https://gorm.io/zh_CN/docs/advanced_query.html">https://gorm.io/zh_CN/docs/advanced_query.html</a></p>
<h3><span id="åœºæ™¯-3-æ ¹æ®æ¡ä»¶åŒ…æ‹¬å…³è”è¡¨çš„åˆ—æŸ¥è¯¢è¡Œè®°å½•çš„æŒ‡å®šåˆ—çš„å€¼">åœºæ™¯ 3: æ ¹æ®æ¡ä»¶ï¼ˆåŒ…æ‹¬å…³è”è¡¨çš„åˆ—ï¼‰æŸ¥è¯¢è¡Œè®°å½•çš„æŒ‡å®šåˆ—çš„å€¼</span></h3><p><strong>Sql</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- è¿è¡¨æŸ¥è¯¢</span></span><br><span class="line"><span class="keyword">SELECT</span> s.id, s.grade, s.age, b.name <span class="keyword">as</span> book_name <span class="keyword">FROM</span> student s <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> book b <span class="keyword">ON</span> b.id <span class="operator">=</span> s.book_id <span class="keyword">WHERE</span> s.age <span class="operator">=</span> <span class="number">26</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- å…ˆæŸ¥ä¸»è¡¨ï¼Œå†æ‰¹é‡æŸ¥å…³è”è¡¨</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> student <span class="keyword">WHERE</span> age <span class="operator">=</span> <span class="number">26</span>;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> book  <span class="keyword">WHERE</span> book_id <span class="keyword">IN</span> (<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>GORM æ“ä½œ</strong></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ–¹æ³•ä¸€ï¼šä½¿ç”¨ Preload (GORM çš„æ¨èæ–¹å¼ï¼Œå…ˆæŸ¥ä¸»è¡¨ï¼Œå†æ‰¹é‡æŸ¥å…³è”è¡¨)</span></span><br><span class="line"><span class="keyword">var</span> students []Student</span><br><span class="line"><span class="comment">// Preload(&quot;Book&quot;) ä¼šè‡ªåŠ¨æ‰§è¡Œä¸€æ¬¡ JOIN æˆ–é¢å¤–çš„ SELECT æ¥åŠ è½½å…³è”çš„ Book</span></span><br><span class="line">db.Preload(<span class="string">&quot;Book&quot;</span>).Where(<span class="string">&quot;age = ?&quot;</span>, <span class="number">26</span>).Find(&amp;students)</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ–¹æ³•äºŒï¼šä½¿ç”¨ Joins + Scan (é€‚ç”¨äºéœ€è¦ä»å…³è”è¡¨é€‰æ‹©ç‰¹å®šåˆ—)</span></span><br><span class="line"><span class="keyword">type</span> StudentBookInfo <span class="keyword">struct</span> &#123;</span><br><span class="line">    ID        <span class="type">uint</span></span><br><span class="line">    Grade     <span class="type">string</span></span><br><span class="line">    Age       <span class="type">int</span></span><br><span class="line">    BookName  <span class="type">string</span> <span class="string">`gorm:&quot;column:book_name&quot;`</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> infos []StudentBookInfo</span><br><span class="line"></span><br><span class="line">db.Table(<span class="string">&quot;students s&quot;</span>).</span><br><span class="line">    Select(<span class="string">&quot;s.id, s.grade, s.age, b.name as book_name&quot;</span>).</span><br><span class="line">    Joins(<span class="string">&quot;LEFT JOIN books b ON b.id = s.book_id&quot;</span>).</span><br><span class="line">    Where(<span class="string">&quot;s.age = ?&quot;</span>, <span class="number">26</span>).</span><br><span class="line">    Scan(&amp;infos)</span><br></pre></td></tr></table></figure>



<h3><span id="åœºæ™¯-4-æ ¹æ®ä¸»é”®-id-æ›´æ–°æŒ‡å®šåˆ—çš„æ•°æ®å¹¶è¿”å›æ›´æ–°è¡Œçš„è®°å½•">åœºæ™¯ 4: æ ¹æ®ä¸»é”® ID æ›´æ–°æŒ‡å®šåˆ—çš„æ•°æ®ï¼Œå¹¶è¿”å›æ›´æ–°è¡Œçš„è®°å½•</span></h3><p><strong>Sql</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> student <span class="keyword">SET</span> grade <span class="operator">=</span> &quot;3å¹´çº§&quot;, age <span class="operator">=</span> <span class="number">27</span> <span class="keyword">WHERE</span> id <span class="operator">=</span> <span class="number">1</span>;</span><br></pre></td></tr></table></figure>

<p><strong>GORM æ“ä½œ</strong></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> updatedStudent Student</span><br><span class="line">db.First(&amp;updatedStudent, studentID)</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨ Updates åªæ›´æ–°æŒ‡å®šå­—æ®µ</span></span><br><span class="line">result = db.Model(&amp;updatedStudent).Updates(<span class="keyword">map</span>[<span class="type">string</span>]<span class="keyword">interface</span>&#123;&#125;&#123;</span><br><span class="line">  <span class="string">&quot;grade&quot;</span>: <span class="string">&quot;4å¹´çº§&quot;</span>,</span><br><span class="line">  <span class="string">&quot;age&quot;</span>:   <span class="number">28</span>,</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// æˆ–è€…ä½¿ç”¨ç»“æ„ä½“ï¼ˆæ³¨æ„ï¼šé›¶å€¼ä¸ä¼šè¢«æ›´æ–°ï¼Œå¦‚ int 0, string &quot;&quot;ï¼‰</span></span><br><span class="line"><span class="comment">// db.Model(&amp;updatedStudent).Updates(Student&#123;Grade: &quot;4å¹´çº§&quot;, Age: 28&#125;)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> result.Error != <span class="literal">nil</span> &#123;</span><br><span class="line">  fmt.Printf(<span class="string">&quot;æ›´æ–°å¤±è´¥: %v\n&quot;</span>, result.Error)</span><br><span class="line">  <span class="keyword">return</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3><span id="åœºæ™¯-5-æ’å…¥ä¸€æ¡æ–°æ•°æ®å¦‚æœæ•°æ®å·²å­˜åœ¨åˆ™æ›´æ–°upsert">åœºæ™¯ 5: æ’å…¥ä¸€æ¡æ–°æ•°æ®ï¼Œå¦‚æœæ•°æ®å·²å­˜åœ¨åˆ™æ›´æ–°ï¼ˆUPSERTï¼‰</span></h3><p><strong>Sql</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT INTO</span> student (name, age, grade, book_id) </span><br><span class="line"><span class="keyword">VALUES</span> (<span class="string">&#x27;å¼ ä¸‰&#x27;</span>, <span class="number">25</span>, <span class="string">&#x27;2å¹´çº§&#x27;</span>, <span class="number">1</span>)</span><br><span class="line"><span class="keyword">ON</span> DUPLICATE KEY <span class="keyword">UPDATE</span> </span><br><span class="line">    age <span class="operator">=</span> <span class="keyword">VALUES</span>(age), </span><br><span class="line">    grade <span class="operator">=</span> <span class="keyword">VALUES</span>(grade),</span><br><span class="line">    updated_at <span class="operator">=</span> <span class="built_in">CURRENT_TIMESTAMP</span>;</span><br></pre></td></tr></table></figure>

<p><strong>æ³¨æ„:</strong> æ­¤è¯­å¥ä¾èµ–äºè¡¨ä¸Šçš„å”¯ä¸€ç´¢å¼•ï¼ˆ<code>UNIQUE KEY</code>ï¼‰ã€‚ä¾‹å¦‚ï¼Œä½ éœ€è¦åœ¨ <code>name</code> å­—æ®µä¸Šå»ºç«‹å”¯ä¸€ç´¢å¼•ï¼Œå½“æ’å…¥é‡å¤çš„ <code>name</code> æ—¶ï¼Œ<code>ON DUPLICATE KEY</code> å­å¥æ‰ä¼šè§¦å‘ã€‚</p>
<p><strong>GORM æ“ä½œ</strong></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å‡è®¾ name å­—æ®µæ˜¯å”¯ä¸€ç´¢å¼•</span></span><br><span class="line">student := Student&#123;</span><br><span class="line">  Name:  <span class="string">&quot;å¼ ä¸‰&quot;</span>, <span class="comment">// è¿™ä¸ªåå­—åœ¨æ•°æ®åº“ä¸­å·²å­˜åœ¨</span></span><br><span class="line">  Age:   <span class="number">26</span>,    <span class="comment">// æ–°çš„å¹´é¾„</span></span><br><span class="line">  Grade: <span class="string">&quot;3å¹´çº§&quot;</span>, <span class="comment">// æ–°çš„å¹´çº§</span></span><br><span class="line">  BookID: <span class="number">1</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨ Clauses å®ç° UPSERT</span></span><br><span class="line">result := db.Clauses(clause.OnConflict&#123;</span><br><span class="line">  Columns:   []clause.Column&#123;&#123;Name: <span class="string">&quot;name&quot;</span>&#125;&#125;, <span class="comment">// å”¯ä¸€ç´¢å¼•çš„åˆ—</span></span><br><span class="line">  DoUpdates: clause.Assignments(<span class="keyword">map</span>[<span class="type">string</span>]<span class="keyword">interface</span>&#123;&#125;&#123;</span><br><span class="line">      <span class="string">&quot;age&quot;</span>:   student.Age,</span><br><span class="line">      <span class="string">&quot;grade&quot;</span>: student.Grade,</span><br><span class="line">      <span class="comment">// GORM ä¼šè‡ªåŠ¨å¤„ç† updated_at</span></span><br><span class="line">  &#125;),</span><br><span class="line">&#125;).Create(&amp;student)</span><br></pre></td></tr></table></figure>

</div><div class="tags"><ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%90%8E%E7%AB%AF/" rel="tag">åç«¯</a></li></ul></div><div class="post-nav"><a class="pre" href="/posts/%E6%96%B0%E6%89%8B%E4%B9%9F%E8%83%BD%E6%87%82%E7%9A%84%E5%88%86%E5%B1%82%E8%AE%BE%E8%AE%A1%EF%BC%9A%E4%B8%BA%E4%BB%80%E4%B9%88%E9%A1%B9%E7%9B%AE%E9%87%8C%E8%A6%81%E5%85%88%E5%AE%9A%E4%B9%89%E6%8E%A5%E5%8F%A3%E5%86%8D%E5%AE%9E%E7%8E%B0%EF%BC%9F/">æ–°æ‰‹ä¹Ÿèƒ½æ‡‚çš„åˆ†å±‚è®¾è®¡ï¼šä¸ºä»€ä¹ˆé¡¹ç›®é‡Œè¦å…ˆå®šä¹‰æ¥å£å†å®ç°</a><a class="next" href="/posts/%E4%B8%87%E7%B1%B3%E8%B7%91%E5%90%8E%E7%9A%84%E6%B5%81%E6%B0%B4%E8%B4%A6/">ä¸‡ç±³è·‘åçš„æµæ°´è´¦</a></div></div></div></div><div class="pure-u-1 pure-u-md-4-4"><div id="footer">Copyright Â© 2026 <a href="/." rel="nofollow">RenaXu 's Wonderland.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=1.0.0" async></script><script type="text/javascript" src="https://unpkg.com/@fancyapps/fancybox/dist/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=1.0.0" async></script><link rel="stylesheet" type="text/css" href="https://unpkg.com/@fancyapps/fancybox/dist/jquery.fancybox.min.css"><link rel="stylesheet" type="text/css" href="/css/search.css?v=1.0.0"><script type="text/javascript" src="/js/search.js?v=1.0.0"></script><script>var search_path = 'search.xml';
if (search_path.length == 0) {
  search_path = 'search.xml';
}
var path = '/' + search_path;
searchFunc(path, 'local-search-input', 'local-search-result');
</script><script type="text/javascript" src="/js/copycode.js?v=1.0.0" successtext="å¤åˆ¶æˆåŠŸï¼"></script><link rel="stylesheet" type="text/css" href="/css/copycode.css?v=1.0.0"><script type="text/javascript" src="/js/codeblock-resizer.js?v=1.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=1.0.0"></script><script type="text/javascript" src="/js/toc.js?v=1.0.0"></script></div></body></html>